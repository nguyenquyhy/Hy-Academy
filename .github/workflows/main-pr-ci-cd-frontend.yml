name: Deploy a new site for each pull request

on:
  pull_request:
    branches: [ main ]
env:
  PRNUMNER: 'academy${{github.event.pull_request.number}}'
  
permissions:
    id-token: write
    contents: read
  
jobs:
  Azure-Storage-Account:
     runs-on: ubuntu-latest
     environment: Pull Requests
     steps:
          - name: Azure Login
            uses: Azure/login@v1.4.2
            with: 
                client-id: ${{ secrets.DEPLOYMENT_SERVICE_PRINCIPAL_CLIENT_ID }}
                tenant-id: ${{ secrets.DEPLOYMENT_SERVICE_PRINCIPAL_TENANT_ID }}
                subscription-id: ${{ secrets.DEPLOYMENT_SERVICE_PRINCIPAL_SUBSCRIPTION_ID }}
          
          - name: Azure logout
            run: |
                  az logout
            if: always()
